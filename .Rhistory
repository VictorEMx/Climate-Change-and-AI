knitr::opts_chunk$set(echo = TRUE)
library(splines)
fit<-lm(wage~bs(age, knots=c(25, 40, 60)), data=Wage)
gam1<-lm(wage~ns(year, 4) + ns(age, 5) + education, data=Wage)
library (ISLR)
attach (Wage)
summary (Wage)
gam1<-lm(wage~ns(year, 4) + ns(age, 5) + education, data=Wage)
gam1<-lm(wage~ns(year, 4) + ns(age, 5) + education, data=Wage)
library(gam)
gam.m3<-gam(wage~s(year, 4) + s(age, 5) + education, data=Wage)
par(mfrow =c(1,3))
plot(gam.m3, se=TRUE ,col ="blue ")
plot.Gam(gam1, se=TRUE, col ="red")
gam.m1<-gam(wage~s(age, 5) + education, data=Wage)
gam.m2<-gam(wage~year+s(age, 5) + education, data=Wage)
gam.m3<-gam(wage~s(year, 4) + s(age, 5) + education, data=Wage)
anova(gam.m1, gam.m2, gam.m3, test="F")
summary(gam.m2)
gam.lr<-gam(I(wage >250)~year+s(age, df=5) + education, family =binomial, data=Wage)
par(mfrow=c(1,3))
plot(gam.lr, se=T, col="green")
table(education, I(wage>250))
